
# BankAPI with fastAPI + sqlAlchemy


## Setup Instructions



### Installation

1. Clone the repository:
   ```sh
   git clone https://github.com/boychukmk/Bank.git
   cd Bank
   ```
2. Create .venv:
   ```sh
    python -m venv .venv
    source .venv/bin/activate  # On Windows use `.venv\Scripts\activate`
   ``` 

3. Install dependencies:
   ```sh
   pip install -r requirements.txt
   ```

4. Set up environment variables:
   Create a `.env` file in the root directory and add your db (example):
   ```
   echo -e "DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/db_name" > .env
   ```

5. Apply database migrations:
   ```sh
   alembic upgrade head
   ```

5. Start the FastAPI server:
   ```sh
    uvicorn app.main:app --reload
   ```

## üìò API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –¥–æ—Å—Ç—É–ø–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:

Swagger UI: http://localhost:8000/docs

Redoc: http://localhost:8000/redoc

## üìò API endpoints
### üîÅ `/upload_csv/{table_name}`  
**POST** ‚Äì –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –≤–∏–±—Ä–∞–Ω—É —Ç–∞–±–ª–∏—Ü—é –∑ CSV

**–û–ø–∏—Å:**  
–î–æ–∑–≤–æ–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ TSV-—Ñ–∞–π–ª (—Ç–∞–±–ª–∏—á–∫–∞, —Ä–æ–∑–¥—ñ–ª–µ–Ω–∞ —Ç–∞–±—É–ª—è—Ü—ñ—î—é) –¥–ª—è –æ–¥–Ω—ñ—î—ó –∑ —Ç–∞–±–ª–∏—Ü—å:  
`users`, `credits`, `dictionary`, `plans`, `payments`.

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `table_name` ‚Äî –Ω–∞–∑–≤–∞ —Ç–∞–±–ª–∏—Ü—ñ (—É URL)
- `file` ‚Äî —Ñ–∞–π–ª —Ç–∏–ø—É CSV/TSV (–Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ —É –ø—Ä–æ—î–∫—Ç—ñ –¥–ª—è sep='\t')

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:**
```json
{
  "message": "Successfully uploaded 30 records to users.",
  "note": "Available tables: users, credits, dictionary, plans, payments"
}
```

---

### üìÑ `/user_credits/{user_id}`  
**GET** ‚Äì –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫—Ä–µ–¥–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

**–û–ø–∏—Å:**  
–ü–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ –∫—Ä–µ–¥–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:

- **–î–∞—Ç–∞ –≤–∏–¥–∞—á—ñ**
- **–°—Ç–∞—Ç—É—Å:** –∑–∞–∫—Ä–∏—Ç–∏–π —á–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π
- –Ø–∫—â–æ **–∑–∞–∫—Ä–∏—Ç–∏–π**:
  - –î–∞—Ç–∞ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è
  - –°—É–º–∞ –≤–∏–¥–∞—á—ñ
  - –ù–∞—Ä–∞—Ö–æ–≤–∞–Ω—ñ –≤—ñ–¥—Å–æ—Ç–∫–∏
  - –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤
- –Ø–∫—â–æ **–≤—ñ–¥–∫—Ä–∏—Ç–∏–π**:
  - –ö—Ä–∞–π–Ω—è –¥–∞—Ç–∞ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è
  - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ –ø—Ä–æ—Å—Ç—Ä–æ—á–∫–∏
  - –°—É–º–∞ —Ç—ñ–ª–∞ –∫—Ä–µ–¥–∏—Ç—É
  - –í—ñ–¥—Å–æ—Ç–∫–∏
  - –°—É–º–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤ –ø–æ —Ç—ñ–ª—É —Ç–∞ –ø–æ –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö

---

### üìÑ `/plans_insert`  
**POST** ‚Äì –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–ª–∞–Ω—ñ–≤ –Ω–∞ –Ω–æ–≤–∏–π –º—ñ—Å—è—Ü—å

**–û–ø–∏—Å:**
- –ü—Ä–∏–π–º–∞—î Excel-—Ñ–∞–π–ª –∑ –ø–æ–ª—è–º–∏: `period`, `category_name`, `sum`
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î:
  - –§–æ—Ä–º–∞—Ç –ø–µ—Ä—à–æ–≥–æ —á–∏—Å–ª–∞ –º—ñ—Å—è—Ü—è —É –ø–æ–ª—ñ `period`
  - –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ (–ø–ª–∞–Ω –∑ —Ü–∏–º –º—ñ—Å—è—Ü–µ–º —ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é –≤–∂–µ —ñ—Å–Ω—É—î)
  - –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø—É—Å—Ç–∏—Ö –∑–Ω–∞—á–µ–Ω—å —É –ø–æ–ª—ñ `sum`

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**  
JSON —ñ–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–±–æ —Å–ø–∏—Å–æ–∫ –ø–æ–º–∏–ª–æ–∫.

---

### üìä `/month_performance`  
**GET** ‚Äì –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–ª–∞–Ω—ñ–≤ –Ω–∞ –ø–µ–≤–Ω—É –¥–∞—Ç—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**  
- `date` (query param): –¥–∞—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (`YYYY-MM-DD`)

**–ü–æ–≤–µ—Ä—Ç–∞—î:**
- –ú—ñ—Å—è—Ü—å –ø–ª–∞–Ω—É
- –ù–∞–∑–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- –°—É–º–∞ –∑ –ø–ª–∞–Ω—É
- –§–∞–∫—Ç–∏—á–Ω–∞ —Å—É–º–∞:
  - –î–ª—è "–í–∏–¥–∞—á–∞" ‚Äî —Å—É–º–∞ –≤–∏–¥–∞–Ω–∏—Ö –∫—Ä–µ–¥–∏—Ç—ñ–≤
  - –î–ª—è "–ó–±—ñ—Ä" ‚Äî —Å—É–º–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤
- % –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–ª–∞–Ω—É

---

### üìà `/year_performance`  
**GET** ‚Äì –ó–≤–µ–¥–µ–Ω–Ω—è –ø–æ –º—ñ—Å—è—Ü—è—Ö –∑–∞ —Ä—ñ–∫

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `year` (query param): —Ä—ñ–∫ (`YYYY`)

**–ü–æ–≤–µ—Ä—Ç–∞—î:**
- –ú—ñ—Å—è—Ü—å —Ç–∞ —Ä—ñ–∫
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–¥–∞—á
- –°—É–º–∞ –∑ –ø–ª–∞–Ω—É –ø–æ –≤–∏–¥–∞—á–∞–º
- –§–∞–∫—Ç–∏—á–Ω–∞ —Å—É–º–∞ –≤–∏–¥–∞—á
- % –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–ª–∞–Ω—É –ø–æ –≤–∏–¥–∞—á–∞–º
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–ª–∞—Ç–µ–∂—ñ–≤
- –°—É–º–∞ –∑ –ø–ª–∞–Ω—É –ø–æ –∑–±–æ—Ä–∞–º
- –§–∞–∫—Ç–∏—á–Ω–∞ —Å—É–º–∞ –ø–ª–∞—Ç–µ–∂—ñ–≤
- % –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–æ –∑–±–æ—Ä–∞–º
- % –≤—ñ–¥ —Ä—ñ—á–Ω–æ–≥–æ –æ–±—Å—è–≥—É –≤–∏–¥–∞—á/–∑–±–æ—Ä—ñ–≤
